<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <script>
    // Pré-remplissage à partir de l'URL
    window.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(window.location.search);
      for (const [key, value] of params.entries()) {
        const input = document.querySelector(`[name="${key}"]`);
        if (input) input.value = value;
      }
      manageForm();
    });

    function manageForm() {
      document.getElementById('notion-form').addEventListener('submit', async function (e) {
        e.preventDefault();
    
        const form = e.target;
        const data = Object.fromEntries(new FormData(form).entries());
    
        const response = await fetch("https://script.google.com/macros/s/AKfycbygXnrPwrHFPGvo202zojY_VijDQnU7WO8zPXepkJDYNAo7HT9Ko_85g98yPx7ZZkks9g/exec", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(data)
        });
    
        const text = await response.text();
        alert("Réponse serveur : " + text);
      });
    }
</script>
  <title>Ajout Notion</title>
</head>
<body>
  <h1>Ajouter une annonce</h1>
  <form id="notion-form">
    <input name="titre" placeholder="Titre de l'annonce" required><br>
    <input name="localisation" placeholder="Commune"><br>
    <input name="surface" type="number" placeholder="Surface en m²"><br>
    <input name="prix" type="number" placeholder="Prix"><br>
    <input name="image_url" placeholder="URL image"><br>
    <input name="url" placeholder="Lien de l’annonce"><br>
    <input name="tags" placeholder="Tags (séparés par des virgules)"><br>
    <textarea name="commentaire" placeholder="Commentaire"></textarea><br>
    <button type="submit">Envoyer</button>
  </form>
</body>
</html>
